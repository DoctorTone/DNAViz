{"version":3,"sources":["js/pdiview.js","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["AWF","BWF","GWF","CWF","Aco","Bco","Cco","Gcos","Ncw","Ncs","Nso","Pcc","Pcs","Pco","Pso","BGCOLORS","lowsaturation","higsaturation","logos","rgbyc","DEBUG","basePairReps","appearanceConfig","Back","BBone","A","DNA_HEX_COLOURS","MOLECULE_A","G","MOLECULE_G","T","MOLECULE_T","C","MOLECULE_C","Pairs","Protein","saveConfig","dna_axis","orientation","zoom","reference_orientation_component","NDBColors","DEFAULT_X_ROT","Math","PI","DEFAULT_Y_ROT","DEFAULT_Z_ROT","DNAViz","moleculeColours","DNA_COLOURS","MOLECULE_U","moleculeHexColours","basePairRepColours","i","numPairs","length","push","slice","currentRep","baseName","messageTimer","createColourScheme","prefs","localStorage","getItem","value","prop","setGUI","NGL","ColormakerRegistry","addSelectionScheme","index","molecule","colour","base","console","log","AXIS_PATH","BACKBONE_PATH","CRPATH","PROTEIN_PATH","PPATH","IPATH","SPATH","stage","Stage","pdbRG","loadFile","then","c","some","do_input","error","axRG","bbRG","crRG","do_ax","rg","component","do_bb","Promise","all","RG","repData","autoView","forEach","rep","$","extend","RGdata","GUI","setRotation","window","addEventListener","event","handleResize","direction","rotateModel","zoomInModel","zoomOutModel","visibilityConfig","NAcid","Axis","_this","guiWidth","css","parseInt","controlKit","ControlKit","addPanel","label","width","innerWidth","enable","addSubGroup","addColor","colorMode","onChange","onBackgroundColourChanged","onBackboneColourChanged","onMoleculeColourChanged","MOLECULES","addSelect","selected","onChangeBasePairRepresentation","colours","getRepresentationColours","applyValue","onChangeProteinRepresentation","addCheckbox","toggleAcid","toggleBackbone","toggleAxis","toggleProtein","addButton","savePreferences","setParameters","backgroundColor","changeColourScheme","setComponentParameters","changeBasePairColour","representation","toggle","newValue","parseFloat","isNaN","elemList","numElems","contextmenu","config","setItem","displayMessage","msg","html","show","setTimeout","hide","document","ready","e","Detector","webgl","modal","on","addClass","removeClass","app","init","createScene","createGUI","zoomIn","zoomOut","stopNotifications","safariw","data","target","url","URL","createObjectURL","location","href","comp","MutuallyExclusiveRepresentationGroup","addRepresentation","do_cr","read_file","fname","parser","done","get","parse_pairings","pairings","lines","split","values","invert_hash","hash","_hash","key","hasOwnProperty","parse_interactions","interactions","parse_sequence","sequence","vertical_sequence","group","basepair","append","click","nenable","_normalize","name","horizontal_sequence","a","b","forb","revb","tname","parent","children","each","td","toggleClass","enabled","reprList","do_interactions","pairings_file","interactions_file","sequence_file","rev_pairings","res1","allresidues","map","interactiongroup","InteractionGroup","join","addInteraction","hydrophobic","_autoView","sele","duration","animationControls","zoomMove","getCenter","getZoom","selection","representations","defaultParameters","RepresentationGroup","call","prototype","Object","create","setVisibility","what","repr","all_empty","atom1","atom2","parameters","atomPair","labelColor","color","opacity","scale","labelUnit","labelSize","err","capitalize","string","charAt","toUpperCase","get_axis","structure","atoms","atomStore","n","count","x","y","z","Vector3","normalize","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","isParcelRequire","WebSocket","hostname","protocol","ws","onmessage","JSON","parse","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","message","stack","overlay","createErrorOverlay","body","appendChild","getElementById","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","cb"],"mappings":"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","file":"pdiview.e2e60662.js","sourceRoot":"..","sourcesContent":["/**\r\n * Created by DrTone on 04/07/2017.\r\n */\r\n\r\n/*\r\n * Copyright (C) 2015-2017 Marco Pasi <mf.pasi@gmail.com>\r\n *\r\n * This program is free software; you can redistribute it and/or modify\r\n * it under the terms of the GNU General Public License as published by\r\n * the Free Software Foundation; either version 2 of the License, or\r\n * (at your option) any later version.\r\n */\r\n\r\n/**** PDIView\r\n * version 0.1\r\n ****/\r\n\r\n/**** Changelog\r\n * v0.1\t\tFirst draft\r\n ****/\r\n\r\n/**** TODO\r\n * color unused DNA gray/transparent?\r\n * get \"initial\" orientation at the end of initial tranformations (catch some event? wait some time?)\r\n * fix rotateCamera* methods with new viewerControls\r\n * - remove Safari Hack for image download when Safari supports download file name setting (see webkit bug 102914).\r\n * look AT interactions, ideally from the interaction groove\r\n */\r\n\r\n\r\n/* GLOBAL SETTINGS */\r\nvar AWF = 0.3,                  // radius for Axis\r\n    BWF = 0.3,                  // radius for Backbone\r\n    GWF = 0.3,                  // radius for Grooves\r\n    CWF = 0.3;                  // radius for Curvature vectors\r\nvar Aco = \"midnightblue\",\r\n    Bco = \"darkred\",\r\n    Cco = Aco,\r\n    Gcos= [\"mediumvioletred\",\"darkorange\",\"pink\",\"silver\"],\r\n    Ncw = \"gray\",\r\n    Ncs = \"khaki\",\r\n    Nso = 0.5, // opacity\r\n    Pcc = \"steelblue\",\r\n    Pcs = \"skyblue\",\r\n    Pco = 0.5,\r\n    Pso = 0.5; // opacity\r\nvar BGCOLORS =[\"lightgray\",\"white\",\"black\",\"powderblue\"];\r\n// NDB colors\r\nvar lowsaturation = //RGBYC\r\n    [0xE6BEBE, 0xBEE6BE, 0xBEBEE6, 0xE6E6AA, 0xBEE6E6];\r\nvar higsaturation = //RGBYC\r\n    [0xFF7070, 0xA0FFA0, 0xA0A0FF, 0xFFFF70, 0x70FFFF];\r\nvar logos = //RGBYC\r\n    [0x00720D, 0xFFCB00, 0x2AB400, 0xFF9200, 0x70FFFF];\r\nvar rgbyc = logos;\r\n/*\r\nvar NDBColors = NGL.ColormakerRegistry.addSelectionScheme( [ // A red, T blue, C yellow, G green, and U cyan.\r\n    [rgbyc[0],\"DA or A\"],\r\n    [rgbyc[1],\"DG or G\"],\r\n    [rgbyc[2],\"DT\"],\r\n    [rgbyc[3],\"DC or C\"],\r\n    [rgbyc[4],\"U\"],\r\n    [\"gray\",\"*\"]\r\n], \"DNA_Protein\");\r\n*/\r\nvar DEBUG = false;\r\n\r\n/* GLOBALS */\r\nlet basePairReps = [\"Wire\", \"Element\", \"Surface\", \"Cylinder\", \"Smooth\", \"Spacefill\", \"Slab\"];\r\nlet appearanceConfig = {\r\n    Back: '#000000',\r\n    BBone: '#8b0000',\r\n    A: DNA_HEX_COLOURS.MOLECULE_A,\r\n    G: DNA_HEX_COLOURS.MOLECULE_G,\r\n    T: DNA_HEX_COLOURS.MOLECULE_T,\r\n    C: DNA_HEX_COLOURS.MOLECULE_C,\r\n    Pairs: basePairReps,\r\n    Protein: [\"Cartoon\", \"Wire\", \"Surface\", \"Ribbon\", \"Rope\", \"Tube\"]\r\n};\r\n\r\nlet saveConfig = {\r\n    Back: '#000000'\r\n};\r\n\r\nvar dna_axis, orientation, zoom;\r\nvar reference_orientation_component = null;\r\nlet NDBColors;\r\nconst DEFAULT_X_ROT = -Math.PI/4;\r\nconst DEFAULT_Y_ROT = 0;\r\nconst DEFAULT_Z_ROT = Math.PI/2;\r\nclass DNAViz {\r\n    constructor() {\r\n        let moleculeColours = [\r\n            DNA_COLOURS.MOLECULE_A,\r\n            DNA_COLOURS.MOLECULE_G,\r\n            DNA_COLOURS.MOLECULE_T,\r\n            DNA_COLOURS.MOLECULE_C,\r\n            DNA_COLOURS.MOLECULE_U\r\n        ];\r\n        let moleculeHexColours = [\r\n            DNA_HEX_COLOURS.MOLECULE_A,\r\n            DNA_HEX_COLOURS.MOLECULE_G,\r\n            DNA_HEX_COLOURS.MOLECULE_T,\r\n            DNA_HEX_COLOURS.MOLECULE_C,\r\n        ];\r\n        this.basePairReps = basePairReps;\r\n        this.basePairRepColours = [];\r\n        for(let i=0, numPairs = this.basePairReps.length; i<numPairs; ++i) {\r\n            this.basePairRepColours.push(moleculeHexColours.slice(0));\r\n        }\r\n        this.currentRep = 0;\r\n        this.moleculeColours = moleculeColours;\r\n        this.baseName = \"DNAVizConfig\";\r\n        this.messageTimer = 3 * 1000;\r\n    }\r\n\r\n    init() {\r\n        this.createColourScheme();\r\n        //Load any preferences\r\n        let prefs = localStorage.getItem(this.baseName + \"Saved\");\r\n        if(prefs) {\r\n            let value;\r\n            for (let prop in appearanceConfig) {\r\n                value = localStorage.getItem(this.baseName + prop);\r\n                if (value) {\r\n                    this.setGUI(prop, value);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    createColourScheme() {\r\n        NDBColors = NGL.ColormakerRegistry.addSelectionScheme(\r\n            [\r\n                [this.moleculeColours[0], \"DA or A\"],\r\n                [this.moleculeColours[3], \"DG or G\"],\r\n                [this.moleculeColours[2], \"DT\"],\r\n                [this.moleculeColours[1], \"DC or C\"],\r\n                [this.moleculeColours[4], \"U\"],\r\n                [\"gray\", \"*\"]\r\n            ], \"DNA_Protein\");\r\n    }\r\n\r\n    getRepresentationColours(index) {\r\n        return this.basePairRepColours[index];\r\n    }\r\n\r\n    changeColourScheme(molecule, colour) {\r\n        this.moleculeColours[molecule] = colour;\r\n        this.createColourScheme();\r\n    }\r\n\r\n    changeBasePairColour(molecule, colour) {\r\n        let base = this.basePairRepColours[this.currentRep];\r\n        base[molecule] = colour;\r\n        //DEBUG\r\n        console.log(\"Rep = \", this.currentRep);\r\n        console.log(\"Colour = \", colour);\r\n    }\r\n\r\n    createScene(AXIS_PATH, BACKBONE_PATH, CRPATH, PROTEIN_PATH, PPATH, IPATH, SPATH) {\r\n        this.stage = new NGL.Stage(\"viewport\",\r\n            {\"cameraType\": \"perspective\",\r\n                \"backgroundColor\": appearanceConfig.Back});\r\n\r\n        // Create RepresentationGroups for the input PDB\r\n        let pdbRG = this.stage.loadFile(PROTEIN_PATH)\r\n            .then(function(c) {\r\n                let some = do_input(c);\r\n                //DEBUG\r\n                //$.extend(some, do_interactions(c, PPATH, IPATH, SPATH));//NEW\r\n                return some;\r\n            }, error);\r\n        let axRG, bbRG, crRG;\r\n        // Define dummy axis if we lack one\r\n        if(AXIS_PATH != \"\") {\r\n            // Create RepresentationGroups for the axis PDB\r\n            axRG = this.stage.loadFile(AXIS_PATH)\r\n                .then(function(c) {\r\n                    // Get Axis approximate axis\r\n                    reference_orientation_component = c;\r\n                    return c;})\r\n                .then(do_ax, error);\r\n        } else {\r\n            pdbRG.then(function(rg) {\r\n                reference_orientation_component = rg[\"Nucleic Acid\"].component;\r\n                return rg;});\r\n        }\r\n        if(BACKBONE_PATH != \"\") {\r\n            // Create RepresentationGroups for the backbone PDB\r\n            bbRG = this.stage.loadFile(BACKBONE_PATH).then(do_bb, error);\r\n        }\r\n\r\n        // Wall: resolve all RepresentationGroups\r\n        Promise.all([pdbRG, axRG, bbRG, crRG]).then( RG => {\r\n            // Set initial orientation and zoom\r\n            this.repData = {};\r\n            reference_orientation_component.autoView();\r\n            // Aggregate RepresentationGroups in repdata\r\n            RG.forEach(rep => {\r\n                $.extend(this.repData, rep);\r\n            });\r\n        }).then( () => {\r\n            // Write GUI for RepresentationGroups\r\n            // in specific containers, in a specific order.\r\n            let RGdata = this.repData;\r\n            if(RGdata[\"Nucleic Acid\"])\r\n                RGdata[\"Nucleic Acid\"].GUI(\"nadisplay\", true);\r\n            if(RGdata[\"Axis\"])\r\n                RGdata[\"Axis\"].GUI(\"axdisplay\", true);\r\n            if(RGdata[\"Backbone\"])\r\n                RGdata[\"Backbone\"].GUI(\"bbdisplay\", true);\r\n            if(RGdata[\"MinorGroove\"])\r\n                RGdata[\"MinorGroove\"].GUI(\"gr1display\", false);\r\n            if(RGdata[\"MajorGroove\"])\r\n                RGdata[\"MajorGroove\"].GUI(\"gr2display\", false);\r\n            if(RGdata[\"Curvature\"])\r\n                RGdata[\"Curvature\"].GUI(\"crdisplay\", true);\r\n            if(RGdata[\"Protein\"])\r\n                RGdata[\"Protein\"].GUI(\"prodisplay\", true);\r\n            //Set initial orientation\r\n            this.stage.setRotation(DEFAULT_X_ROT, DEFAULT_Y_ROT, DEFAULT_Z_ROT);\r\n        });\r\n\r\n        window.addEventListener(\r\n            \"resize\", event => {\r\n                this.stage.handleResize();\r\n            }, false\r\n        );\r\n    }\r\n\r\n    rotateModel(direction) {\r\n        this.stage.rotateModel(direction);\r\n    }\r\n\r\n    zoomIn(zoom) {\r\n        this.stage.zoomInModel(zoom);\r\n    }\r\n\r\n    zoomOut(zoom) {\r\n        this.stage.zoomOutModel(zoom);\r\n    }\r\n\r\n    createGUI() {\r\n        //Create GUI - controlKit\r\n        window.addEventListener('load', () => {\r\n\r\n            let visibilityConfig = {\r\n                NAcid: true,\r\n                BBone: true,\r\n                Axis: true,\r\n                Protein: true\r\n            };\r\n\r\n            let _this = this;\r\n            let guiWidth = $('#guiWidth').css(\"width\");\r\n            guiWidth = parseInt(guiWidth, 10);\r\n            //DEBUG\r\n            console.log(\"Gui width = \", guiWidth);\r\n            if(!guiWidth) {\r\n                guiWidth = 10;\r\n            }\r\n            guiWidth /= 100;\r\n\r\n            let controlKit = new ControlKit();\r\n\r\n            controlKit.addPanel({label: \"Configuration\", width: window.innerWidth * guiWidth, enable: true})\r\n                .addSubGroup({label: \"Appearance\", enable: false})\r\n                    .addColor(appearanceConfig, \"Back\", {\r\n                        colorMode: \"hex\", onChange: () => {\r\n                            this.onBackgroundColourChanged(appearanceConfig.Back);\r\n                        }\r\n                    })\r\n                    .addColor(appearanceConfig, \"BBone\", {\r\n                        colorMode: \"hex\", onChange: () => {\r\n                            this.onBackboneColourChanged(appearanceConfig.BBone);\r\n                        }\r\n                    })\r\n                    .addColor(appearanceConfig, \"A\", {\r\n                        colorMode: \"hex\", onChange: () => {\r\n                            this.onMoleculeColourChanged(MOLECULES.A, appearanceConfig.A);\r\n                        }\r\n                    })\r\n                    .addColor(appearanceConfig, \"G\", {\r\n                        colorMode: \"hex\", onChange: () => {\r\n                            this.onMoleculeColourChanged(MOLECULES.G, appearanceConfig.G);\r\n                        }\r\n                    })\r\n                    .addColor(appearanceConfig, \"T\", {\r\n                        colorMode: \"hex\", onChange: () => {\r\n                            this.onMoleculeColourChanged(MOLECULES.T, appearanceConfig.T);\r\n                        }\r\n                    })\r\n                    .addColor(appearanceConfig, \"C\", {\r\n                        colorMode: \"hex\", onChange: () => {\r\n                            this.onMoleculeColourChanged(MOLECULES.C, appearanceConfig.C);\r\n                        }\r\n                    })\r\n                    .addSelect(appearanceConfig, \"Pairs\", {\r\n                        selected: 0,\r\n                        onChange: index => {\r\n                            this.onChangeBasePairRepresentation(index);\r\n                            //Update colour scheme\r\n                            let colours = _this.getRepresentationColours(index);\r\n                            appearanceConfig.A = colours[0];\r\n                            appearanceConfig.G = colours[1];\r\n                            appearanceConfig.T = colours[2];\r\n                            appearanceConfig.C = colours[3];\r\n\r\n                            //Fixes update bug in control kit\r\n                            this.applyValue();\r\n\r\n                            //DEBUG\r\n                            //console.log(\"Rep = \", index);\r\n                            //console.log(\"Colour = \", appearanceConfig.A);\r\n                            //controlKit.update();\r\n                        }\r\n                    })\r\n                    .addSelect(appearanceConfig, \"Protein\", {\r\n                        selected: 0,\r\n                        onChange: index => {\r\n                            this.onChangeProteinRepresentation(index);\r\n                        }\r\n                    })\r\n                .addSubGroup({label: \"Visibility\", enable: false})\r\n                    .addCheckbox(visibilityConfig, \"NAcid\", {\r\n                        onChange: () => {\r\n                            this.toggleAcid();\r\n                        }\r\n                    })\r\n                    .addCheckbox(visibilityConfig, \"BBone\", {\r\n                        onChange: () => {\r\n                            this.toggleBackbone();\r\n                        }\r\n                    })\r\n                    .addCheckbox(visibilityConfig, \"Axis\", {\r\n                        onChange: () => {\r\n                            this.toggleAxis();\r\n                        }\r\n                    })\r\n                    .addCheckbox(visibilityConfig, \"Protein\", {\r\n                        onChange: () => {\r\n                            this.toggleProtein();\r\n                        }\r\n                    })\r\n                .addSubGroup( {label: \"Preferences\"} )\r\n                    .addButton(\"Save\", () => {\r\n                        for(let prop in saveConfig) {\r\n                            if(prop in appearanceConfig) {\r\n                                saveConfig[prop] = appearanceConfig[prop];\r\n                            }\r\n                        }\r\n                        this.savePreferences(saveConfig);\r\n                    });\r\n        });\r\n    }\r\n\r\n    onBackgroundColourChanged(colour) {\r\n        this.stage.setParameters( {backgroundColor: colour} );\r\n    }\r\n\r\n    onBackboneColourChanged(colour) {\r\n        this.repData[\"Backbone\"].setParameters(\r\n            {\"colorScheme\": \"uniform\",\r\n            \"colorValue\":  colour,\r\n            \"radius\":      0.3});\r\n    }\r\n\r\n    onMoleculeColourChanged(molecule, colour) {\r\n        this.changeColourScheme(molecule, colour);\r\n        this.repData[\"Nucleic Acid\"].setComponentParameters(this.currentRep, {\"colorScheme\": NDBColors} );\r\n        //Keep track of colours\r\n        this.changeBasePairColour(molecule, colour);\r\n    }\r\n\r\n    onChangeBasePairRepresentation(representation) {\r\n        this.repData[\"Nucleic Acid\"].enable(representation);\r\n        this.currentRep = representation;\r\n    }\r\n\r\n    onChangeProteinRepresentation(representation) {\r\n        this.repData[\"Protein\"].enable(representation);\r\n    }\r\n\r\n    toggleAcid() {\r\n        this.repData[\"Nucleic Acid\"].toggle();\r\n    }\r\n\r\n    toggleBackbone() {\r\n        this.repData[\"Backbone\"].toggle();\r\n    }\r\n\r\n    toggleAxis() {\r\n        this.repData[\"Axis\"].toggle();\r\n    }\r\n\r\n    toggleProtein() {\r\n        this.repData[\"Protein\"].toggle();\r\n    }\r\n\r\n    setGUI(prop, value) {\r\n        let newValue = parseFloat(value);\r\n        if(isNaN(newValue)) {\r\n            appearanceConfig[prop] = value;\r\n            return;\r\n        }\r\n        appearanceConfig[prop] = newValue;\r\n    }\r\n\r\n    stopNotifications(elemList) {\r\n        for(let i=0, numElems=elemList.length; i<numElems; ++i) {\r\n            $('#' + elemList[i]).contextmenu(() => {\r\n                return false;\r\n            });\r\n        }\r\n    }\r\n\r\n    savePreferences(config) {\r\n        for(let prop in config) {\r\n            localStorage.setItem(this.baseName + prop, config[prop]);\r\n        }\r\n        localStorage.setItem(this.baseName+\"Saved\", \"Saved\");\r\n        this.displayMessage(\"Preferences saved\");\r\n    }\r\n\r\n    displayMessage(msg) {\r\n        $('#content').html(msg);\r\n        $('#message').show();\r\n        setTimeout( () => {\r\n            $('#message').hide();\r\n        }, this.messageTimer);\r\n    }\r\n}\r\n\r\n$(document).ready(function(e){\r\n\r\n    if(!Detector.webgl) {\r\n        $(\"#notSupported\").show();\r\n        return;\r\n    }\r\n\r\n    $('#mainModal').modal();\r\n\r\n    $('#hideDetails').on(\"click\", () => {\r\n        $('#graphs').addClass(\"d-none\");\r\n        $('#showInfo').removeClass(\"d-none\");\r\n    });\r\n\r\n    $('#showDetails').on(\"click\", () => {\r\n        $('#graphs').removeClass(\"d-none\");\r\n        $('#showInfo').addClass(\"d-none\");\r\n    });\r\n\r\n    $('#hideSequence').on(\"click\", () => {\r\n        $('#sequenceInfo').addClass(\"d-none\");\r\n        $('#toggleSequenceInfo').removeClass(\"d-none\");\r\n    });\r\n\r\n    $('#showSequence').on(\"click\", () => {\r\n        $('#sequenceInfo').removeClass(\"d-none\");\r\n        $('#toggleSequenceInfo').addClass(\"d-none\");\r\n    });\r\n\r\n\r\n    let app = new DNAViz();\r\n    app.init();\r\n    app.createScene(\"data/output_X.pdb\",\r\n        \"data/output_B.pdb\",\r\n        \"data/output_R.pdb\",\r\n        \"data/output.pdb\",\r\n        \"data/pairings.dat\",\r\n        \"data/interactions.dat\",\r\n        \"data/sequence.dat\");\r\n    app.createGUI();\r\n\r\n    $('#rotateLeft').on(\"mousedown\", () => {\r\n        app.rotateModel(-1);\r\n    });\r\n\r\n    $('#rotateLeft').on(\"mouseup\", () => {\r\n        app.rotateModel(0);\r\n    });\r\n\r\n    $('#rotateRight').on(\"mousedown\", () => {\r\n        app.rotateModel(1);\r\n    });\r\n\r\n    $('#rotateRight').on(\"mouseup\", () => {\r\n        app.rotateModel(0);\r\n    });\r\n\r\n    $('#zoomIn').on(\"mousedown\", () => {\r\n        app.zoomIn(true);\r\n    });\r\n\r\n    $('#zoomIn').on(\"mouseup\", () => {\r\n        app.zoomIn(false);\r\n    });\r\n\r\n    $('#zoomOut').on(\"mousedown\", () => {\r\n        app.zoomOut(true);\r\n    });\r\n\r\n    $('#zoomOut').on(\"mouseup\", () => {\r\n        app.zoomOut(false);\r\n    });\r\n\r\n    $('#rotateLeft').on(\"touchstart\", () => {\r\n        app.rotateModel(-1);\r\n    });\r\n\r\n    $('#rotateLeft').on(\"touchend\", () => {\r\n        app.rotateModel(0);\r\n    });\r\n\r\n    $('#rotateRight').on(\"touchstart\", () => {\r\n        app.rotateModel(1);\r\n    });\r\n\r\n    $('#rotateRight').on(\"touchend\", () => {\r\n        app.rotateModel(0);\r\n    });\r\n\r\n    $('#zoomIn').on(\"touchstart\", () => {\r\n        app.zoomIn(true);\r\n    });\r\n\r\n    $('#zoomIn').on(\"touchend\", () => {\r\n        app.zoomIn(false);\r\n    });\r\n\r\n    $('#zoomOut').on(\"mousedown\", () => {\r\n        app.zoomOut(true);\r\n    });\r\n\r\n    $('#zoomOut').on(\"mouseup\", () => {\r\n        app.zoomOut(false);\r\n    });\r\n\r\n    let elemList = [\"rotateControls\", \"zoomControls\"];\r\n    app.stopNotifications(elemList);\r\n});\r\n\r\nfunction safariw(data, target) {\r\n    var url = URL.createObjectURL( data );\r\n    target.location.href = url;\r\n}\r\n\r\n/*************************\r\n * Representation callbacks\r\n *\r\n * Configure representations here.\r\n * Each method creates a dictionary of RepresentationGroups, one\r\n * for each selection relevant for the specified component.\r\n * These are subsequently aggregated and used to design GUI.\r\n *\r\n */\r\nfunction do_input(comp) {\r\n    //Add some custom shapes\r\n    /*\r\n    let shape = new NGL.Shape( \"shape\" );\r\n    shape.addCone([0, 2, 7], [0, 3, 3], [1, 1, 0], 1.5);\r\n    let shapeComp = stage.addComponentFromObject(shape);\r\n    shapeComp.addRepresentation(\"cone\");\r\n    */\r\n    return {\r\n        // Nucleic\r\n        \"Nucleic Acid\":\r\n            new MutuallyExclusiveRepresentationGroup(comp, \"Nucleic Acid\", \"nucleic\")\r\n                .addRepresentation( \"Wire\",\r\n                    comp.addRepresentation( \"licorice\",   {\"colorScheme\": NDBColors}))\r\n                .addRepresentation( \"Element\",\r\n                    comp.addRepresentation( \"ball+stick\", {\"colorScheme\": \"element\"}))\r\n                .addRepresentation( \"Surface\",\r\n                    comp.addRepresentation( \"surface\",    {\"opacity\": Nso,\r\n                        \"colorScheme\": \"uniform\",\r\n                        \"colorValue\":  Ncs}))\r\n                .addRepresentation( \"Cylinder\",\r\n                    comp.addRepresentation( \"base\",   {\"colorScheme\": NDBColors}))\r\n                .addRepresentation( \"Smooth\",\r\n                    comp.addRepresentation( \"hyperball\",   {\"colorScheme\": NDBColors}))\r\n                .addRepresentation( \"Spacefill\",\r\n                    comp.addRepresentation( \"spacefill\",   {\"colorScheme\": NDBColors}))\r\n                .addRepresentation( \"Slab\",\r\n                    comp.addRepresentation( \"slab\",   {\"colorScheme\": NDBColors})),\r\n        // Protein\r\n        \"Protein\":\r\n            new MutuallyExclusiveRepresentationGroup(comp, \"Protein\", \"protein\")\r\n                .addRepresentation( \"Cartoon\",\r\n                    comp.addRepresentation( \"cartoon\",  {\"colorScheme\":   \"uniform\",\r\n                        \"colorValue\":    Pcc,\r\n                        \"opacity\":       Pco}))\r\n                .addRepresentation( \"Wire\",\r\n                    comp.addRepresentation( \"licorice\", {\"colorScheme\":  \"element\"}))\r\n                .addRepresentation( \"Surface\",\r\n                    comp.addRepresentation( \"surface\",  {\"opacity\": Pso,\r\n                        \"colorScheme\": \"uniform\",\r\n                        \"colorValue\":  Pcs}))\r\n                .addRepresentation( \"Ribbon\",\r\n                    comp.addRepresentation( \"ribbon\", {\"colorScheme\": \"uniform\",\r\n                        \"colorValue\": Pcc}))\r\n                .addRepresentation( \"Rope\",\r\n                    comp.addRepresentation( \"rope\", {\"colorScheme\": \"uniform\",\r\n                        \"colorValue\": Pcc}))\r\n                .addRepresentation( \"Tube\",\r\n                    comp.addRepresentation( \"tube\", {\"colorScheme\": \"uniform\",\r\n                        \"colorValue\": Pcc}))\r\n    };\r\n}\r\n\r\nfunction do_ax(comp) {\r\n    return {\r\n        \"Axis\":\r\n            new MutuallyExclusiveRepresentationGroup(comp, \"Axis\", null)\r\n                .addRepresentation( null,\r\n                    comp.addRepresentation( \"licorice\", {\"colorScheme\": \"uniform\",\r\n                        \"colorValue\":  Aco,\r\n                        \"radius\":      AWF}))\r\n    };\r\n}\r\n\r\nfunction do_bb(comp) {\r\n    return {\r\n        \"Backbone\":\r\n            new MutuallyExclusiveRepresentationGroup(comp, \"Backbone\", \"(:A or :B)\")\r\n                .addRepresentation(null,\r\n                    comp.addRepresentation( \"licorice\", {\"colorScheme\": \"uniform\",\r\n                        \"colorValue\":  Bco,\r\n                        \"radius\":      BWF})),\r\n        \"MinorGroove\":\r\n            new MutuallyExclusiveRepresentationGroup(comp, \"MinorGroove\", \":C\")\r\n                .addRepresentation(null,\r\n                    comp.addRepresentation( \"licorice\", {\"colorScheme\": \"uniform\",\r\n                        \"colorValue\":  Gcos[0],\r\n                        \"radius\":      GWF})),\r\n        \"MajorGroove\":\r\n            new MutuallyExclusiveRepresentationGroup(comp, \"MajorGroove\", \":D\")\r\n                .addRepresentation(null,\r\n                    comp.addRepresentation( \"licorice\", {\"colorScheme\": \"uniform\",\r\n                        \"colorValue\":  Gcos[1],\r\n                        \"radius\":      GWF})),\r\n    };\r\n}\r\n\r\nfunction do_cr(comp) {\r\n    return {\r\n        \"Curvature\":\r\n            new MutuallyExclusiveRepresentationGroup(comp, \"Curvature\", null)\r\n                .addRepresentation(null,\r\n                    comp.addRepresentation( \"licorice\", {\"colorScheme\": \"uniform\",\r\n                        \"colorValue\":  Cco,\r\n                        \"radius\":      CWF}))\r\n    };\r\n}\r\n\r\n/*************************\r\n *\r\n */\r\nfunction read_file(fname, parser, done) {\r\n    $.get(fname).done(function(data) {\r\n        done(parser(data));\r\n    });\r\n}\r\n\r\nfunction parse_pairings(data) {\r\n    var pairings = {};\r\n    var lines = data.split('\\n');\r\n    for (var i=0; i<lines.length-1; i++) {\r\n        // resi1 resi2\r\n        var values = lines[i].split('\\t');\r\n        pairings[values[1]] = values[0];\r\n    }\r\n    return pairings;\r\n}\r\n\r\nfunction invert_hash(hash) {\r\n    var _hash = {};\r\n    for (var key in hash)\r\n        if (hash.hasOwnProperty(key))\r\n            _hash[hash[key]] = key;\r\n    return _hash;\r\n}\r\n\r\nfunction parse_interactions(data, pairings) {\r\n    var interactions = {};\r\n    var lines = data.split('\\n');\r\n    for (var i=0; i<lines.length-1; i++) {\r\n        // resi1 chain1 resn1 atom1 resi2 chain2 resn2 atom2 ?H\r\n        var values = lines[i].split('\\t');\r\n        var key = values[0]+\":\"+values[1];\r\n        if(key in pairings)\r\n            key = pairings[key];\r\n        if(!(key in interactions))\r\n            interactions[key] = [];\r\n        interactions[key].push(values);\r\n    }\r\n    return interactions;\r\n}\r\n\r\nfunction parse_sequence(data) {\r\n    var sequence = [];\r\n    var lines = data.split('\\n');\r\n    for (var i=0; i<lines.length-1; i++) {\r\n        // resn1 resn2\r\n        var values = lines[i].split('\\t');\r\n        sequence.push(values);\r\n    }\r\n    return sequence;\r\n}\r\n\r\nfunction vertical_sequence(sequence, group) {\r\n    var c = $(\"<ol/>\")\r\n    sequence.forEach(function(basepair, i) {\r\n        c.append($(\"<li/>\").append(\r\n            $(\"<a/>\").click(function(e) {\r\n                group.nenable(basepair[2]);\r\n            }).append(basepair[0]+\"--\"+basepair[1])));\r\n    });\r\n    return c;\r\n}\r\n\r\nfunction _normalize(name) {\r\n    if(name[0] == \"D\")\r\n        name = name.slice(1);\r\n    return name;\r\n}\r\n\r\nfunction horizontal_sequence(sequence, group) {\r\n    // var c = $(\"<table/>\")\r\n    // var fors = $(\"<tr/>\");\r\n    // var lins = $(\"<tr/>\");\r\n    // var revs = $(\"<tr/>\");\r\n    // sequence.forEach(function(basepair, i) {\r\n    //     forb = _normalize(basepair[0]);\r\n    //     revb = _normalize(basepair[1]);\r\n\r\n    //     fors.append($(\"<td/>\").append(\r\n    //         $(\"<a/>\").click(function(e) {\r\n    //             group.nenable(basepair[2]);\r\n    //         }).append(forb)));\r\n\r\n    //     revs.append($(\"<td/>\").append(\r\n    //         $(\"<a/>\").click(function(e) {\r\n    //             group.nenable(basepair[2]);\r\n    //         }).append(revb)));\r\n\r\n    //     lins.append($(\"<td/>\").append(\r\n    //         $(\"<a/>\").click(function(e) {\r\n    //             group.nenable(basepair[2]);\r\n    //         }).append(\"|\")));\r\n    // });\r\n    // c.append(fors);\r\n    // c.append(lins);\r\n    // c.append(revs);\r\n    // return c;\r\n    var a = $(\"<div/>\");\r\n    var b = $(\"<table/>\")\r\n    var c = $(\"<tr/>\");\r\n    c.append($(\"<th/>\", {\"class\":\"seq_initial\"})\r\n        .append(\"5'-<br/><br/>3'-\"));\r\n    sequence.forEach(function(basepair, i) {\r\n        forb = _normalize(basepair[0]);\r\n        revb = _normalize(basepair[1]);\r\n        c.append($(\"<td/>\")\r\n            .click(function(e) {\r\n                var tname = basepair[2];\r\n                $(this).parent().children().each(function(i, td) {\r\n                    $(td).toggleClass('active', false);\r\n                });\r\n                if(group.enabled >= 0 && group.reprList[group.enabled].name == tname) {\r\n                    group.enable(-1);\r\n                }else{\r\n                    group.nenable(tname);\r\n                    $(this).toggleClass('active');\r\n                }\r\n            })\r\n            .append(forb+\"<br/>|<br/>\"+revb));\r\n    });\r\n    c.append($(\"<th/>\", {\"class\":\"seq_final\"})\r\n        .append(\"-3'<br/><br/>-5'\"));\r\n    b.append(c);\r\n    // b.append($(\"<span/>\")\r\n    //         .click(function(e){\r\n    //             group.enable(-1);\r\n    //         }).append($(\"<a/>\").append(\"hide\")));\r\n    a.append(b);\r\n    return a;\r\n}\r\n\r\nfunction do_interactions(comp, pairings_file, interactions_file, sequence_file) {\r\n    var group = new MutuallyExclusiveRepresentationGroup(comp, \"Interactions\", null);\r\n\r\n    read_file(pairings_file, parse_pairings, function(pairings) {\r\n        read_file(interactions_file, function(data) {\r\n            return parse_interactions(data, pairings);\r\n        }, function(interactions) {\r\n            var rev_pairings = invert_hash(pairings);\r\n            for(var res1 in interactions) {\r\n                // resi1 chain1 resn1 atom1 resi2 chain2 resn2 atom2 ?H\r\n                var allresidues = interactions[res1].map(function(values){\r\n                    return values[4]+\":\"+values[5];\r\n                });\r\n                allresidues.push(res1);\r\n                if(res1 in rev_pairings)\r\n                    allresidues.push(rev_pairings[res1]);\r\n                var interactiongroup = new InteractionGroup(\r\n                    comp, res1, \"(\"+allresidues.join(\" or \")+\")\")\r\n                    .addRepresentation( \"Ball&Stick\",\r\n                        comp.addRepresentation( \"ball+stick\", {\"colorScheme\": \"element\",\r\n                            \"colorValue\":  \"#006b8f\"}));\r\n                interactions[res1].forEach(function(values) {\r\n                    interactiongroup.addInteraction(\r\n                        values[0]+\":\"+values[1]+\".\"+values[3],\r\n                        values[4]+\":\"+values[5]+\".\"+values[7],\r\n                        hydrophobic = values[8] == \"H\");\r\n                });\r\n                group.addRepresentation(res1, interactiongroup)\r\n            }\r\n        });\r\n    });\r\n\r\n    /* Hack in some GUI */\r\n    read_file(sequence_file, parse_sequence, function(sequence) {\r\n        // var c = vertical_sequence(sequence, group);\r\n        var c = horizontal_sequence(sequence, group);\r\n        $(\"#sequence\").append(c);\r\n    });\r\n    group.toggle(true);\r\n    return {\"Interactions\": group};\r\n}\r\n\r\n\r\n/*************************\r\n * Interaction representation group API\r\n */\r\nfunction _autoView(component, sele, duration) {\r\n    component.stage.animationControls.zoomMove(\r\n        component.getCenter( sele ),\r\n        component.getZoom( sele ) * 0.5,\r\n        duration\r\n    );\r\n}\r\nvar InteractionGroup = function(component, name, selection, representations,\r\n                                defaultParameters) {\r\n    RepresentationGroup.call(this, component, name, selection, representations, defaultParameters);\r\n};\r\nInteractionGroup.prototype = Object.create(RepresentationGroup.prototype);\r\n\r\nInteractionGroup.prototype.setVisibility = function(what) {\r\n    // Show/Hide all representations in group, and focus/zoom\r\n    this.reprList.forEach(function(repr) {\r\n        repr.setVisibility(what);\r\n    });\r\n    if(what) {\r\n        _autoView(this.component, this.selection, 1000);\r\n        // var axis = get_axis(repr.repr.structure);\r\n        // rotateCameraTo(axis);\r\n        // rotateCameraAxisAngle(cc(new NGL.Vector3(1,0,0)), -Math.PI/2)\r\n    }\r\n}\r\n\r\nInteractionGroup.prototype.all_empty = function() {};\r\nInteractionGroup.prototype.GUI = function() {};\r\nInteractionGroup.prototype.addInteraction = function(atom1, atom2, hydrophobic) {\r\n    /*\r\n     * Add an interaction to this group.\r\n     */\r\n    hydrophobic = typeof hydrophobic === 'undefined' ? false : hydrophobic;\r\n    var parameters = {\r\n        atomPair: [[atom1, atom2]],\r\n        labelColor: \"black\",\r\n        color: \"blue\",\r\n        opacity: 0.5,\r\n        scale: 0.25,\r\n        labelUnit: \"angstrom\",\r\n        labelSize: 0.75\r\n    };\r\n    if(hydrophobic) {\r\n        parameters[\"labelSize\"] = 0;\r\n        parameters[\"color\"] = \"green\";\r\n    }\r\n    this.addRepresentation( \"distance\",\r\n        this.component.addRepresentation(\r\n            \"distance\", parameters));\r\n    return this;\r\n}\r\n\r\n/*************************\r\n * Promise functions\r\n */\r\nfunction error(err) {\r\n    console.log(err);\r\n}\r\n\r\n/*************************\r\n * Utilities\r\n */\r\nfunction capitalize(string) {\r\n    return string.charAt(0).toUpperCase() + string.slice(1);\r\n}\r\n\r\nfunction get_axis(structure) {\r\n    var atoms = structure.atomStore,\r\n        n = atoms.count-1,\r\n        x = atoms.x[0] - atoms.x[n],\r\n        y = atoms.y[0] - atoms.y[n],\r\n        z = atoms.z[0] - atoms.z[n];\r\n    return new NGL.Vector3(x,y,z).normalize();\r\n}\r\n\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else {\n        window.location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}